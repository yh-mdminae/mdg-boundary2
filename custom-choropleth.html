<!-- A minimal custom choropleth map for Looker Studio (Community Visualization) -->
<!-- This will display your TopoJSON with color scaling -->

<!DOCTYPE html>
<html>
  <head>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <style>
      body { margin: 0; }
      svg { width: 100%; height: 100vh; }
    </style>
  </head>
  <body>
    <svg></svg>
    <script>

  console.log("Script is running âœ…");

  const svg = d3.select("svg");
  const path = d3.geoPath();
  const color = d3.scaleSequential(d3.interpolateOranges);

  let data = {};

  // ðŸŸ¡ Start of fetch block
  console.log("Starting fetch...");

  fetch("https://yh-mdminae.github.io/mdg-boundary2/madagascar_districts.topojson")
    .then(response => {
      console.log("Fetch successful");
      return response.json();
    })
    .then(topo => {
      console.log("Received topo:", topo);

      const features = topojson.feature(topo, topo.objects["gadm41_MDG_2"]).features;
      console.log("Loaded features:", features);
      console.log("Example feature properties:", features[0].properties);

      data = {

    "Antananarivo-Atsimondrano": 80,
    "Antsirabe II": 45,
    "Toamasina I": 60


      };

      const values = Object.values(data);
      color.domain([Math.min(...values), Math.max(...values)]);

      svg.selectAll("path")
        .data(features)
        .enter().append("path")
        .attr("d", path)
        .attr("fill", d => {
          const name = d.properties.NAME_2;
          return data[name] != null ? color(data[name]) : "#ccc";
        })
        .attr("stroke", "#fff");
    })
    .catch(err => {
      console.error("Fetch failed:", err);
    });
</script>

    </script>
  </body>
</html>
